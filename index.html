<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Kho Ảnh Của Tui - Có Sẵn Thư Mục images</title>
    <style>
      body {
        font-family: Segoe UI;
        background: #000;
        color: #0ff;
        margin: 0;
        padding: 20px;
        min-height: 100vh;
      }
      h1 {
        text-align: center;
        margin: 40px 0 20px;
        font-size: 3.5em;
        text-shadow: 0 0 30px #0ff;
      }
      #drop {
        border: 6px dashed #0ff;
        padding: 120px;
        text-align: center;
        font-size: 2.5em;
        border-radius: 25px;
        margin: 40px 0;
        background: rgba(0, 255, 255, 0.1);
        transition: 0.4s;
        cursor: pointer;
      }
      #drop.dragover {
        background: rgba(0, 255, 255, 0.3);
        transform: scale(1.03);
      }
      #gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
        gap: 22px;
        margin-top: 40px;
      }
      .item {
        position: relative;
        border-radius: 18px;
        overflow: hidden;
        box-shadow: 0 10px 40px rgba(0, 255, 255, 0.5);
        transition: 0.4s;
        cursor: pointer;
      }
      .item:hover {
        transform: translateY(-15px) scale(1.06);
        box-shadow: 0 20px 60px rgba(0, 255, 255, 0.8);
      }
      .item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        aspect-ratio: 1;
      }
      .info {
        text-align: center;
        font-size: 2em;
        margin: 30px;
        color: #0ff;
        font-weight: bold;
      }
      #lightbox {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.97);
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        z-index: 9999;
      }
      #lightbox.hidden {
        display: none;
      }
      #close {
        position: absolute;
        top: 20px;
        right: 30px;
        font-size: 90px;
        cursor: pointer;
        color: #fff;
      }
      #big {
        max-width: 94%;
        max-height: 85vh;
        border-radius: 20px;
        box-shadow: 0 0 60px #0ff;
      }
    </style>
  </head>
  <body>
    <h1>KHO ẢNH CỦA TUI</h1>
    <div class="info" id="info">
      Thư mục images đã sẵn sàng! Kéo ảnh vào đây hoặc tự thêm vào code cũng
      được!
    </div>
    <div id="drop">KÉO ẢNH MỚI VÀO ĐÂY ĐỂ THÊM VÀO KHO</div>
    <div id="gallery"></div>

    <div id="lightbox" class="hidden">
      <div id="close">X</div>
      <img id="big" />
      <div
        style="margin-top: 20px; color: #ccc; font-size: 1.3em"
        id="filename"
      ></div>
    </div>

    <script>
      // ================================
      // KHO ẢNH ẢO CÓ SẴN - BẠN CHỈ CẦN THÊM DÒNG MỚI VÀO ĐÂY
      // ================================
      const builtinImages = [
        // Ví dụ cách thêm ảnh (bạn chỉ cần copy-paste dòng này):
        // {name: "mèo con.jpg", base64: "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQ..."},

        // === BẠN THÊM ẢNH CỦA BẠN TẠI ĐÂY ===
        // Copy 1 trong 2 cách dưới đây để thêm ảnh:

        // Cách 1: Dán link ảnh online (dễ nhất)
        { name: "Anh cưới ", base64: "images/IMGL1922.JPG" },
        // Cách 2: Dán base64 thật (nếu bạn muốn ảnh nằm 100% trong file)
        // {name: "tên ảnh.jpg", base64: "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD..."}
      ];

      // Load ảnh có sẵn + ảnh đã lưu trước đó
      let db;
      const request = indexedDB.open("KhoAnhCuaTui_2025", 1);
      request.onupgradeneeded = (e) => {
        db = e.target.result;
        db.createObjectStore("images", { keyPath: "id", autoIncrement: true });
      };
      request.onsuccess = (e) => {
        db = e.target.result;
        loadAll();
      };

      async function loadAll() {
        // 1. Load ảnh có sẵn trong code
        builtinImages.forEach((img) => addToGallery(img.base64, img.name));

        // 2. Load ảnh đã lưu trước đó (kéo thả)
        const tx = db.transaction("images", "readonly");
        const store = tx.objectStore("images");
        const req = store.getAll();
        req.onsuccess = () => {
          req.result.forEach((i) =>
            addToGallery(URL.createObjectURL(i.blob), i.name)
          );
          document.getElementById(
            "info"
          ).textContent = `Kho đã sẵn sàng! Tổng ${
            document.querySelectorAll(".item").length
          } ảnh`;
        };
      }

      // Thêm vào gallery
      function addToGallery(src, name) {
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `<img src="${src}" loading="lazy">`;
        div.title = name;
        div.onclick = () => {
          document.getElementById("big").src = src;
          document.getElementById("filename").textContent = name;
          document.getElementById("lightbox").classList.remove("hidden");
        };
        document.getElementById("gallery").appendChild(div);
      }

      // Kéo thả ảnh mới → lưu vĩnh viễn
      const drop = document.getElementById("drop");
      ["dragover", "dragenter"].forEach((e) =>
        drop.addEventListener(e, (ev) => {
          ev.preventDefault();
          drop.classList.add("dragover");
        })
      );
      ["dragleave", "drop"].forEach((e) =>
        drop.addEventListener(e, (ev) => {
          ev.preventDefault();
          drop.classList.remove("dragover");
        })
      );

      drop.ondrop = (e) => {
        e.preventDefault();
        [...e.dataTransfer.files].forEach((file) => {
          if (file.type.startsWith("image/")) {
            const reader = new FileReader();
            reader.onload = (ev) => {
              const blob = new Blob([ev.target.result], { type: file.type });
              db.transaction("images", "readwrite")
                .objectStore("images")
                .add({ blob, name: file.name });
              addToGallery(URL.createObjectURL(blob), file.name);
            };
            reader.readAsArrayBuffer(file);
          }
        });
      };

      // Click để chọn ảnh
      drop.onclick = () => {
        const i = document.createElement("input");
        i.type = "file";
        i.multiple = true;
        i.accept = "image/*";
        i.onchange = () =>
          [...i.files].forEach((f) => {
            const reader = new FileReader();
            reader.onload = (ev) => {
              const blob = new Blob([ev.target.result], { type: f.type });
              db.transaction("images", "readwrite")
                .objectStore("images")
                .add({ blob, name: f.name });
              addToGallery(URL.createObjectURL(blob), f.name);
            };
            reader.readAsArrayBuffer(f);
          });
        i.click();
      };

      document.getElementById("close").onclick = () =>
        document.getElementById("lightbox").classList.add("hidden");
    </script>
  </body>
</html>
